<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>xia2: Automated Data Reduction</title>
  </head>

  <body>
    <h1>xia2: Automated Data Reduction</h1>

    <p>xia2 is a new automated data reduction system designed to work from raw
      diffraction data and a little metadata, and produce usefully reduced
      data in a form suitable for immediately starting phasing and structure
      solution, e.g. through Mr BUMP or your favourite experimental phasing
      suite.</p>

    <p>The following steps are performed (although not strictly in 
      this order)</p>

    <ul>
      <li>Integration with feedback and complex lattice selection stuff</li>
      <li>Reindexing to standard setting for spacegroup (e.g. P 2 21 21 to
	P 21 21 2)</li>
      <li>Scaling together of all data to maximise anomalous signal</li>
      <li>Estimation of number of molecules in ASU and solvent fraction
	based on sequence information (if provided)</li>
    </ul>

    <p>There is a lot of fun stuff which goes on in there - run it to find 
      out more...</p>
    
    <p>The system is designed to cope with MAD data and data measured in 
      multiple passes, or a combination of the two. The input is a therefore
      a little complex, but consists only of information you should have 
      to hand anyway - here is a simple example, a more complex example 
      can be found below.</p>

    <pre>
! This is a demonstration .xinfo file which illustrates how to cope
! with a simple case - this example is a native cubic insulin data
! set measured on 14.2 at the SRS

BEGIN PROJECT DEMONSTRATION

BEGIN CRYSTAL INSULIN

BEGIN AA_SEQUENCE

! this is only really needed at the moment for assessing the solvent
! content and number of residues in the asu

GIVEQCCASVCSLYQLENYCN
FVNQHLCGSHLVEALYLVCGERGFFYTPKA

END AA_SEQUENCE

BEGIN WAVELENGTH NATIVE

! this doesn't have to be here - if it is not included then the values from 
! the image headers will be used - however if it is there then it should
! be correct!

WAVELENGTH 0.979000

! in here you can also have
! F' value
! F'' value

END WAVELENGTH NATIVE

BEGIN SWEEP NATIVE
WAVELENGTH NATIVE
IMAGE insulin_1_001.img

! you will probably need to change this - this is the only thing which 
! you will need to change for the demonstration data set

DIRECTORY /media/data1/graeme/demo/

! additionally you can add the following information - if it is wrong
! in the headers
! BEAM x y (mm)
! DISTANCE z (mm)

! this describes the order in which the sweeps were collected - 
! it usually comes from the image header if that information is in there
! EPOCH 5

! you can also add this to only reduce a subset of the data 
! START_END 1 30 (image numbers)

END SWEEP 

END CRYSTAL INSULIN

END PROJECT DEMONSTRATION
    </pre>

    <p>This uses test images which are available from the links below. 
      Thanks to John Cowan for providing this test data!</p>

    <ul>
      <li><a href="demo.zip">Windows (as .zip file)</a></li>
      <li><a href="demo.tar.bz2">Unix (as .tar.bz2 file)</a></li>
      <li><a href="demo.tar.gz">Unix (as .tar.gz file)</a></li>
    </ul>

    <p>Here are a couple of templates - for native data from two sweeps, 
      SAD data from one sweep, MAD data from three wavelengths - all 
      you need to do is select an appropriate one and add your own
      information! Please note - if you wish to comment something out
      from a .xinfo file, simply at a "!" at the beginning 
      of the appropriate lines.</p>

    <ul>
      <li><a href="NATIVE.xinfo">Native data</a></li>
      <li><a href="SAD.xinfo">SAD data</a></li>
      <li><a href="MAD.xinfo">MAD data</a></li>
    </ul>

    <p>More examples can be found in $DPA_ROOT/examples. Remember - you need 
      to tell xia2 where to find your data! Answers to frequently asked
      questions can be found <a href="faq.html">here</a>.</p>

    <h1>Platforms</h1>

    <p>The following platforms are supported (see notes at bottom of page
      for platform specific advice.)</p>

    <ul>
      <li>GNU/Linux on i386 (and 64 bit extensions)</li>
      <li>OS X 10.4 i386 and Power PC G4/G5</li>
      <li>Microsoft Windows 2000/XP (Vista is untested)</li>
    </ul>

    <h1>Supported Detector Types</h1>

    <p>The following detectors are supported:</p>

    <ul>
     <li>ADSC CCD detectors</li>
     <li>MAR CCD detectors</li>
     <li>MAR 345 image plates</li>
     <li>RAXIS IV image plates</li>
    </ul>

    <p>If you have another detector class which needs support, please get 
      in touch.</p>

    <h1>Requirements</h1>

    <p>The only software which is actually required is CCP4 6.0.1/2 and Python
      2.4.x. On Windows the PyWin32 module is also required, to provide
      additional process control functionality. If you are using this 
      on a Windows platform and wish to be able to use the integration
      functionality, you should get in touch with Harry Powell for a custom
      build of Mosflm.</p>

    <p>In addition the autoindexing program Labelit is supported but the 
      system will work without it. If it is installed (and it should be a 
      moderately recent version) then it will be used for autoindexing.</p>

    <h1>License</h1>

    <p>This software is distributed under the BSD license for all users.
      Everyone who uses this software is invited to join the xia2bb
      mailing list. Finally, if you use this software in solving a structure
      which is published, please acknowledge it! Thanks!</p>

    <p>A copy of the license is available here.</p>

    <p>This software depends apon CCP4 and will also make use of Labelit - 
      users are reminded that it is their responsibility to have properly
      obtained licenses for this software.</p>

    <h1>Download</h1>

    <p>The current version, 0.2.2.4 can be obtained by following these 
      links:</p>

    <ul>
      <li><a href="xia2-0.2.2.4.zip">Windows (as .zip file)</a></li>
      <li><a href="xia2-0.2.2.4.tar.bz2">Unix (as .tar.bz2 file)</a></li>
      <li><a href="xia2-0.2.2.4.tar.gz">Unix (as .tar.gz file)</a></li>
    </ul>

    <p>All of the files are the same, simply packed for different platforms.
      Inside are a number of precompiled jiffy programs and pointless and
      othercell (also available from the CCP4 
      <a href="http://www.ccp4.ac.uk/prerelease_page.php">prerelease</a>
      pages) for convenience.</p>

    <h1>Installation</h1>

    <p>Since everything is precompiled, the only requirement is to unpack the
      directory somewhere and edit the directory setup.bat, setup.csh or
      setup.sh appropriately, for instance setting XIA2_HOME as 
      /opt/px/xia/xia-0.2.2.4 if you unpacked the tarball in /opt/px/xia.
      Note that this includes the xia-0.2.2.4 directory!</p>

    <p>All that is then needed is to source this setup file and the application
      xia2 should be available. Apologies to those (t)csh users out there
      who found that the setup scripts were broken! They are fixed now...</p>

    <h1>Usage</h1>

    <p>Once the software is installed, the first thing you need to do is 
      prepare a .xinfo file (example above) to run from. This contains a 
      description of the experiment, which will allow xia2 to decide how to 
      handle your data and what information to put in the MTZ headers.</p>
      
    <p>Essentially the input file just needs a description of the data
      which were collected from each crystal - for instance, if you measured
      three MAD wavelengths, a peak, inflection and high remote, then 
      there should be three WAVELENGTH blocks in the file, containing the 
      fp, fpp and wavelength values. The images that you measured from these
      should then be described in the SWEEP block, which is then assigned to 
      a wavelength. This structure simplifies handling of multiple passes
      contributing to one wavelength. In the reduced output, the wavelength 
      names will correspond to MTZ datasets.</p>
    
    <p>The program is actually run with:</p>

    <pre>
xia2 -xinfo project.xinfo
    </pre>
    
    <p>And all data reduction is performed in the working directory, with the
      a directory structure CRYSTAL/WAVELENGTH/SWEEP. Interesting log files
      can be found in the CRYSTAL/scale directory.</p>

    <h1>Acknowledgements</h1>

    <p>Development of xia2 is supported by the BBSRC e-HTPX grant and the 
      EU framework 6 BioXHit initiative. xia2 makes extensive use of Phil 
      Evans's program Pointless, and I would like to thank him for the 
      extensive modifications made to the program. I would also like to thank
      the US structural genomics JCSG group for providing their extensive
      collection of raw diffraction data to methods developers. Finally I 
      would like to acknowledge CCP4, for without their software this project
      would go nowhere!</p>

    <h1>The More Complex Example</h1>

    <p>This example has two crystals, one of which is selenomethionated,
      with two wavelengths (inflection and low remote) measured for the 
      derivative and two native sweeps measured for the native sample.
      Lines beginning with # or ! will be treated as comments.</p>

    <pre>
BEGIN PROJECT TS01
BEGIN CRYSTAL 12847

BEGIN AA_SEQUENCE

MKVKKWVTQDFPMVEESATVRECLHRMRQYQTNECIVKDREGHFRGVVNKEDLLDLDLDSSVFNKVSLPD
FFVHEEDNITHALLLFLEHQEPYLPVVDEEMRLKGAVSLHDFLEALIEALAMDVPGIRFSVLLEDKPGEL
RKVVDALALSNINILSVITTRSGDGKREVLIKVDAVDEGTLIKLFESLGIKIESIEKEEGF

END AA_SEQUENCE

BEGIN WAVELENGTH NATIVE
WAVELENGTH 0.99187
END WAVELENGTH NATIVE

! high resolution native pass

BEGIN SWEEP NATIVE_HR
WAVELENGTH NATIVE
BEAM 109.0 105.0
IMAGE 12847_4_001.img
DIRECTORY /Volumes/Arthur/JCSG Data/1vr9/data/jcsg/als1/8.2.1/20050121/collection/TM0892/12847/
END SWEEP NATIVE_HR

! low resolution native pass

BEGIN SWEEP NATIVE_LR
WAVELENGTH NATIVE
BEAM 109.0 105.0
IMAGE 12847_5_001.img
DIRECTORY /Volumes/Arthur/JCSG Data/1vr9/data/jcsg/als1/8.2.1/20050121/collection/TM0892/12847/
END SWEEP NATIVE_LR

END CRYSTAL 12847

BEGIN CRYSTAL 13140

BEGIN AA_SEQUENCE

MKVKKWVTQDFPMVEESATVRECLHRMRQYQTNECIVKDREGHFRGVVNKEDLLDLDLDSSVFNKVSLPD
FFVHEEDNITHALLLFLEHQEPYLPVVDEEMRLKGAVSLHDFLEALIEALAMDVPGIRFSVLLEDKPGEL
RKVVDALALSNINILSVITTRSGDGKREVLIKVDAVDEGTLIKLFESLGIKIESIEKEEGF

END AA_SEQUENCE

BEGIN HA_INFO
ATOM SE
NUMBER_PER_MONOMER 5
END HA_INFO

BEGIN WAVELENGTH INFL
WAVELENGTH 0.979741
F' -10.0
F'' 3.2
END WAVELENGTH INFL

BEGIN WAVELENGTH LREM
WAVELENGTH 1.019859
F' -2.6
F'' 0.55
END WAVELENGTH LREM

BEGIN SWEEP INFL
WAVELENGTH INFL
BEAM 108.7 102.0
IMAGE 13140_1_E1_001.img
DIRECTORY /Volumes/Arthur/JCSG Data/1vr9/data/jcsg/als1/8.3.1/20050105/collect/TM0892/13140/
END SWEEP

BEGIN SWEEP LREM
WAVELENGTH LREM
BEAM 108.7 102.0
IMAGE 13140_1_E2_001.img
DIRECTORY /Volumes/Arthur/JCSG Data/1vr9/data/jcsg/als1/8.3.1/20050105/collect/TM0892/13140/
END SWEEP

END CRYSTAL 13140

END PROJECT TS01
    </pre>

    <p>This is a particularly complex example, but it illustrates the 
      capability of the system well. There are data from two cystals, one 
      native and the other selenomethionated. The native set is measured in 
      two sweeps. Currently (version 0.2.2.4) no attempt is made to combine 
      data from multiple crystals, however this is on the to-do list.</p>
    
    <h1>Release Notes</h1>

    <p>Changes since 0.2.2.4:</p>

    <ul>
      <li>Changed to a BSD license</li>
      <li>Added "python setup" check to xia2</li>
      <li>Relaxed criteria on isomorphism to 1% not 0.5A etc.</li>
      <li><b>Now wavelengths in wavelength record will override header
	values if provided, but do not (indeed, should not) be included
	if wavelength values are correct.</b></li>
    </ul>

    <p>Changes since 0.2.2.3:</p>
    
    <ul>
      <li>Created version for Power PC G4/G5</li>
      <li>Fixed .csh setup scripts</li>
      <li>If wavelength values not specified in the .xinfo file will use
	values from the image headers</li>
      <li>If loggraph output from scala is broken by having Mn(I/sigma)
	greater than 99.99 can now cope (ignores that record)</li>
      <li>Will now use a maximum of 180 degrees of data for deciding 
	e.g. the point group, spacegroup and correct indexing standards -
	this helps the cases where exceptionally high redundancy data 
	has been measured</li>
    </ul>
    
    <p>Changes since 0.2.2.2:</p>

    <ul>
      <li>Updated printheader to cope with MAR 165</li>
      <li>Cleaner error messages when data missing</li>
      <li>Added support for MAR image plate data</li>
      <li>Included more example .xinfo files in the examples directory</li>
      <li>Relaxed refinement parameters in Mosflm cell refinement</li>
    </ul>

    <h1>Platform Specific Advice</h1>

    <h2>Gfortran compiled CCP4</h2>

    <p>Recent versions of the gcc compiler suite have included a new compiler
      called "gfortran" in place of "g77". This has, unfortunately, been 
      designed with optimisation too high on the agenda, and the output
      from programs can sometimes be mashed. If this happens you need to
      set "GFOTRAN_UNBUFFERED_ALL" to 1 in your environment.</p>

    <h2>Linux</h2>
    
    <p>There should be no particular problems on this platform - assuming
      that you have a recent version of Python. Any 2.4 version should work,
      but I have mostly used 2.4.3 and 2.4.4, and would recommend them.
      If the version you have on your system by default (type "python"
      to find out what version you have)is too old, you can easily install
      a new version, perhaps in the xia directory, from 
      <a href="http://www.python.org/download/releases/2.4.4/">here</a>.
      This is best installed by unpacking the tarball (tar xvfz 
      Python-2.4.4.tgz) then doing ./configure /where/I/want/it then
      make, make install.</p>

    <h2>OS X 10.4</h2>

    <p>The only potential problem with this platform is that the Python 
      which comes as standard is 2.3 - however a universal binary is 
      available from 
      <a href="http://www.python.org/download/releases/2.4.4/">here</a>,
      which should sort out any problems. Just follow the instructions in 
      the disk image.</p>

    <h2>Windows XP</h2>

    <p>Once more you will need a recent version of Python - which can be found
      <a href="http://www.python.org/download/releases/2.4.4/">here</a>,
      however, you will also need "pywin32" to provide a little more
      job control functionality - this is available from 
      <a href="http://sourceforge.net/projects/pywin32/">here</a>. Both are
      simple, double-click, binary installers.</p>

    <hr>

    <address><a href="mailto:g.winter@dl.ac.uk">Graeme Winter</a></address>
<!-- Created: Thu Nov 23 10:24:11 GMT 2006 -->
<!-- hhmts start -->
Last modified: Fri Dec 08 15:29:06 GMT Standard Time 2006
<!-- hhmts end -->
  </body>
</html>
